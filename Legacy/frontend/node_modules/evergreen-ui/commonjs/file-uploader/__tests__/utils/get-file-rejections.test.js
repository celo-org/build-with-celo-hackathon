"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _constants = require("../../../constants");

var _utils = require("../../../test/utils");

var _getFileRejections = _interopRequireDefault(require("../../src/utils/get-file-rejections"));

describe('getFileRejections', function () {
  it.each([undefined, null, {}])('should return empty array when options is %p', function (options) {
    var files = (0, _utils.buildFiles)();
    var expected = [];
    var result = (0, _getFileRejections["default"])(files, options);
    expect(result).toStrictEqual(expected);
  });
  describe('options.acceptedMimeTypes', function () {
    it('should return empty array when empty', function () {
      var acceptedMimeTypes = [];
      var files = (0, _utils.buildFiles)(2, {
        type: _constants.MimeType.png
      });
      var expected = [];
      var result = (0, _getFileRejections["default"])(files, {
        acceptedMimeTypes: acceptedMimeTypes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should not return files that match type', function () {
      var acceptedMimeTypes = [_constants.MimeType.png];
      var files = (0, _utils.buildFiles)(2, {
        type: _constants.MimeType.png
      });
      var expected = [];
      var result = (0, _getFileRejections["default"])(files, {
        acceptedMimeTypes: acceptedMimeTypes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return files that do not match type', function () {
      var acceptedMimeTypes = [_constants.MimeType.gif];
      var expected = [(0, _utils.buildFile)({
        type: _constants.MimeType.png
      })];
      var result = (0, _getFileRejections["default"])(expected, {
        acceptedMimeTypes: acceptedMimeTypes
      });
      expect(result).toHaveLength(expected.length);
    });
  });
  describe('options.maxFiles', function () {
    it('should return empty array when under maxFiles', function () {
      var maxFiles = 5;
      var files = (0, _utils.buildFiles)(maxFiles - 1);
      var expected = [];
      var result = (0, _getFileRejections["default"])(files, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return empty array when equal to maxFiles', function () {
      var maxFiles = 5;
      var files = (0, _utils.buildFiles)(maxFiles);
      var expected = [];
      var result = (0, _getFileRejections["default"])(files, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return empty array when maxFiles less than 1', function () {
      var maxFiles = 0;
      var files = (0, _utils.buildFiles)(maxFiles);
      var expected = [];
      var result = (0, _getFileRejections["default"])(files, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return last N files when over maxFiles', function () {
      var maxFiles = 5;
      var files = (0, _utils.buildFiles)(maxFiles + 3);
      var result = (0, _getFileRejections["default"])(files, {
        maxFiles: maxFiles
      });
      expect(result).toHaveLength(files.length - maxFiles);
    });
    describe('options.currentFileCount', function () {
      it('should return empty array when under maxFiles + currentFileCount', function () {
        var maxFiles = 5;
        var currentFileCount = 1;
        var files = (0, _utils.buildFiles)(maxFiles - currentFileCount - 1);
        var expected = [];
        var result = (0, _getFileRejections["default"])(files, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
      it('should return empty array when equal to maxFiles + currentFileCount', function () {
        var maxFiles = 5;
        var currentFileCount = 1;
        var files = (0, _utils.buildFiles)(maxFiles - currentFileCount);
        var expected = [];
        var result = (0, _getFileRejections["default"])(files, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
      it('should return empty array when currentFileCount less than 1', function () {
        var maxFiles = 5;
        var currentFileCount = -5;
        var files = (0, _utils.buildFiles)(maxFiles);
        var expected = [];
        var result = (0, _getFileRejections["default"])(files, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
      it('should return last N files when over maxFiles + currentFileCount', function () {
        var maxFiles = 5;
        var currentFileCount = 1;
        var files = (0, _utils.buildFiles)(maxFiles + 3);
        var result = (0, _getFileRejections["default"])(files, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toHaveLength(files.length + currentFileCount - maxFiles);
      });
    });
  });
  describe('options.maxSizeInBytes', function () {
    it('should return file greater than maxSizeInBytes', function () {
      var maxSizeInBytes = 10000;
      var files = [(0, _utils.buildFile)({
        size: maxSizeInBytes + 1
      })];
      var result = (0, _getFileRejections["default"])(files, {
        maxSizeInBytes: maxSizeInBytes
      });
      expect(result).toHaveLength(files.length);
    });
    it('should not return file equal to maxSizeInBytes', function () {
      var maxSizeInBytes = 10000;
      var files = [(0, _utils.buildFile)({
        size: maxSizeInBytes
      })];
      var expected = [];
      var result = (0, _getFileRejections["default"])(files, {
        maxSizeInBytes: maxSizeInBytes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should not return file less than maxSizeInBytes', function () {
      var maxSizeInBytes = 10000;
      var files = [(0, _utils.buildFile)({
        size: maxSizeInBytes - 1
      })];
      var expected = [];
      var result = (0, _getFileRejections["default"])(files, {
        maxSizeInBytes: maxSizeInBytes
      });
      expect(result).toStrictEqual(expected);
    });
  });
});