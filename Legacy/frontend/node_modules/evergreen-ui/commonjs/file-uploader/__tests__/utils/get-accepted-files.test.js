"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _constants = require("../../../constants");

var _utils = require("../../../test/utils");

var _getAcceptedFiles = _interopRequireDefault(require("../../src/utils/get-accepted-files"));

describe('getAcceptedFiles', function () {
  it.each([undefined, null, {}])('should return unmodified files when options is %p', function (options) {
    var expected = (0, _utils.buildFiles)();
    var result = (0, _getAcceptedFiles["default"])(expected, options);
    expect(result).toStrictEqual(expected);
  });
  describe('options.acceptedMimeTypes', function () {
    it('should return all files when empty', function () {
      var acceptedMimeTypes = [];
      var expected = (0, _utils.buildFiles)(2, {
        type: _constants.MimeType.png
      });
      var result = (0, _getAcceptedFiles["default"])(expected, {
        acceptedMimeTypes: acceptedMimeTypes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return files that match type', function () {
      var acceptedMimeTypes = [_constants.MimeType.png];
      var expected = (0, _utils.buildFiles)(2, {
        type: _constants.MimeType.png
      });
      var result = (0, _getAcceptedFiles["default"])(expected, {
        acceptedMimeTypes: acceptedMimeTypes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should not return files that do not match type', function () {
      var acceptedMimeTypes = [_constants.MimeType.gif];
      var expected = (0, _utils.buildFile)({
        type: _constants.MimeType.gif
      });
      var unexpected = (0, _utils.buildFile)({
        type: _constants.MimeType.png
      });
      var result = (0, _getAcceptedFiles["default"])([expected, unexpected], {
        acceptedMimeTypes: acceptedMimeTypes
      });
      expect(result).toStrictEqual([expected]);
    });
  });
  describe('options.maxFiles', function () {
    it('should return all files when under maxFiles', function () {
      var maxFiles = 5;
      var expected = (0, _utils.buildFiles)(maxFiles - 1);
      var result = (0, _getAcceptedFiles["default"])(expected, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return all files when equal to maxFiles', function () {
      var maxFiles = 5;
      var expected = (0, _utils.buildFiles)(maxFiles);
      var result = (0, _getAcceptedFiles["default"])(expected, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return all files when maxFiles less than 1', function () {
      var maxFiles = 0;
      var expected = (0, _utils.buildFiles)(maxFiles);
      var result = (0, _getAcceptedFiles["default"])(expected, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return first N files when over maxFiles', function () {
      var maxFiles = 5;
      var files = (0, _utils.buildFiles)(maxFiles + 3);
      var expected = files.slice(0, maxFiles);
      var result = (0, _getAcceptedFiles["default"])(files, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    describe('options.currentFileCount', function () {
      it('should return all files when under maxFiles + currentFileCount', function () {
        var maxFiles = 5;
        var currentFileCount = 1;
        var expected = (0, _utils.buildFiles)(maxFiles - currentFileCount - 1);
        var result = (0, _getAcceptedFiles["default"])(expected, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
      it('should return all files when equal to maxFiles + currentFileCount', function () {
        var maxFiles = 5;
        var currentFileCount = 1;
        var expected = (0, _utils.buildFiles)(maxFiles - currentFileCount);
        var result = (0, _getAcceptedFiles["default"])(expected, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
      it('should return all files when currentFileCount less than 1', function () {
        var maxFiles = 5;
        var currentFileCount = -5;
        var expected = (0, _utils.buildFiles)(maxFiles);
        var result = (0, _getAcceptedFiles["default"])(expected, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
      it('should return first N files when over maxFiles + currentFileCount', function () {
        var maxFiles = 5;
        var currentFileCount = 1;
        var files = (0, _utils.buildFiles)(maxFiles + 3);
        var expected = files.slice(0, maxFiles - currentFileCount);
        var result = (0, _getAcceptedFiles["default"])(files, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
    });
  });
  describe('options.maxSizeInBytes', function () {
    it('should not return file greater than maxSizeInBytes', function () {
      var maxSizeInBytes = 10000;
      var unexpected = [(0, _utils.buildFile)({
        size: maxSizeInBytes + 1
      })];
      var expected = [];
      var result = (0, _getAcceptedFiles["default"])(unexpected, {
        maxSizeInBytes: maxSizeInBytes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return file equal to maxSizeInBytes', function () {
      var maxSizeInBytes = 10000;
      var expected = [(0, _utils.buildFile)({
        size: maxSizeInBytes
      })];
      var result = (0, _getAcceptedFiles["default"])(expected, {
        maxSizeInBytes: maxSizeInBytes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return file less than maxSizeInBytes', function () {
      var maxSizeInBytes = 10000;
      var expected = [(0, _utils.buildFile)({
        size: maxSizeInBytes - 1
      })];
      var result = (0, _getAcceptedFiles["default"])(expected, {
        maxSizeInBytes: maxSizeInBytes
      });
      expect(result).toStrictEqual(expected);
    });
  });
});