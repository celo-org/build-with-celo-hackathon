import { MimeType } from '../../../constants';
import { buildFiles, buildFile } from '../../../test/utils';
import getAcceptedFiles from '../../src/utils/get-accepted-files';
describe('getAcceptedFiles', function () {
  it.each([undefined, null, {}])('should return unmodified files when options is %p', function (options) {
    var expected = buildFiles();
    var result = getAcceptedFiles(expected, options);
    expect(result).toStrictEqual(expected);
  });
  describe('options.acceptedMimeTypes', function () {
    it('should return all files when empty', function () {
      var acceptedMimeTypes = [];
      var expected = buildFiles(2, {
        type: MimeType.png
      });
      var result = getAcceptedFiles(expected, {
        acceptedMimeTypes: acceptedMimeTypes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return files that match type', function () {
      var acceptedMimeTypes = [MimeType.png];
      var expected = buildFiles(2, {
        type: MimeType.png
      });
      var result = getAcceptedFiles(expected, {
        acceptedMimeTypes: acceptedMimeTypes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should not return files that do not match type', function () {
      var acceptedMimeTypes = [MimeType.gif];
      var expected = buildFile({
        type: MimeType.gif
      });
      var unexpected = buildFile({
        type: MimeType.png
      });
      var result = getAcceptedFiles([expected, unexpected], {
        acceptedMimeTypes: acceptedMimeTypes
      });
      expect(result).toStrictEqual([expected]);
    });
  });
  describe('options.maxFiles', function () {
    it('should return all files when under maxFiles', function () {
      var maxFiles = 5;
      var expected = buildFiles(maxFiles - 1);
      var result = getAcceptedFiles(expected, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return all files when equal to maxFiles', function () {
      var maxFiles = 5;
      var expected = buildFiles(maxFiles);
      var result = getAcceptedFiles(expected, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return all files when maxFiles less than 1', function () {
      var maxFiles = 0;
      var expected = buildFiles(maxFiles);
      var result = getAcceptedFiles(expected, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return first N files when over maxFiles', function () {
      var maxFiles = 5;
      var files = buildFiles(maxFiles + 3);
      var expected = files.slice(0, maxFiles);
      var result = getAcceptedFiles(files, {
        maxFiles: maxFiles
      });
      expect(result).toStrictEqual(expected);
    });
    describe('options.currentFileCount', function () {
      it('should return all files when under maxFiles + currentFileCount', function () {
        var maxFiles = 5;
        var currentFileCount = 1;
        var expected = buildFiles(maxFiles - currentFileCount - 1);
        var result = getAcceptedFiles(expected, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
      it('should return all files when equal to maxFiles + currentFileCount', function () {
        var maxFiles = 5;
        var currentFileCount = 1;
        var expected = buildFiles(maxFiles - currentFileCount);
        var result = getAcceptedFiles(expected, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
      it('should return all files when currentFileCount less than 1', function () {
        var maxFiles = 5;
        var currentFileCount = -5;
        var expected = buildFiles(maxFiles);
        var result = getAcceptedFiles(expected, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
      it('should return first N files when over maxFiles + currentFileCount', function () {
        var maxFiles = 5;
        var currentFileCount = 1;
        var files = buildFiles(maxFiles + 3);
        var expected = files.slice(0, maxFiles - currentFileCount);
        var result = getAcceptedFiles(files, {
          currentFileCount: currentFileCount,
          maxFiles: maxFiles
        });
        expect(result).toStrictEqual(expected);
      });
    });
  });
  describe('options.maxSizeInBytes', function () {
    it('should not return file greater than maxSizeInBytes', function () {
      var maxSizeInBytes = 10000;
      var unexpected = [buildFile({
        size: maxSizeInBytes + 1
      })];
      var expected = [];
      var result = getAcceptedFiles(unexpected, {
        maxSizeInBytes: maxSizeInBytes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return file equal to maxSizeInBytes', function () {
      var maxSizeInBytes = 10000;
      var expected = [buildFile({
        size: maxSizeInBytes
      })];
      var result = getAcceptedFiles(expected, {
        maxSizeInBytes: maxSizeInBytes
      });
      expect(result).toStrictEqual(expected);
    });
    it('should return file less than maxSizeInBytes', function () {
      var maxSizeInBytes = 10000;
      var expected = [buildFile({
        size: maxSizeInBytes - 1
      })];
      var result = getAcceptedFiles(expected, {
        maxSizeInBytes: maxSizeInBytes
      });
      expect(result).toStrictEqual(expected);
    });
  });
});